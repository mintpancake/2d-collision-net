from net import *
import torch

net = Net()
sc = torch.Tensor([[[0.2677033777832025, 0.1579239509786319],
                  [0.05812764876992554, 0.27595454455022583],
    [-0.05584088271134396, -0.17543671103059147],
    [0.21111173094425237, -0.1800381709232511],
    [0.08114505278531736, -0.02967572872861089],
    [-0.25983601818688, 0.3673055737629457],
    [-0.04444602921451757, -0.42474534554629156],
    [-0.18270615661483125, 0.380195862180526],
    [0.35831933222388374, 0.1002778372399744],
    [0.24101500418095553, 0.16894045997102397],
    [-0.04718516811672353, 0.3937199374897597],
    [0.3487842959976363, 0.24460395380409142],
    [-0.39095072660278835, 0.2888583094138358],
    [-0.051929763378730585, -0.44812690773252367],
    [-0.26037544090496434, 0.3314083268269735],
    [0.27605097655218913, -0.30015438047215276],
    [-0.17205948891914308, -0.04576022461523524],
    [0.2180344742166115, 0.04293760886352001],
    [-0.23013515365769716, 0.4297320780204003],
    [0.27270909377122865, -0.07162289063074784],
    [0.27270909377122865, -0.07162289063074784]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156],
     [-0.18270615661483125, 0.380195862180526],
     [0.35831933222388374, 0.1002778372399744],
     [0.24101500418095553, 0.16894045997102397],
     [-0.04718516811672353, 0.3937199374897597],
     [0.3487842959976363, 0.24460395380409142],
     [-0.39095072660278835, 0.2888583094138358],
     [-0.051929763378730585, -0.44812690773252367],
     [-0.26037544090496434, 0.3314083268269735],
     [0.27605097655218913, -0.30015438047215276],
     [-0.17205948891914308, -0.04576022461523524],
     [0.2180344742166115, 0.04293760886352001],
     [-0.23013515365769716, 0.4297320780204003],
     [0.27270909377122865, -0.07162289063074784],
     [0.27270909377122865, -0.07162289063074784]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156],
     [-0.18270615661483125, 0.380195862180526],
     [0.35831933222388374, 0.1002778372399744],
     [0.24101500418095553, 0.16894045997102397],
     [-0.04718516811672353, 0.3937199374897597],
     [0.3487842959976363, 0.24460395380409142],
     [-0.39095072660278835, 0.2888583094138358],
     [-0.051929763378730585, -0.44812690773252367],
     [-0.26037544090496434, 0.3314083268269735],
     [0.27605097655218913, -0.30015438047215276],
     [-0.17205948891914308, -0.04576022461523524],
     [0.2180344742166115, 0.04293760886352001],
     [-0.23013515365769716, 0.4297320780204003],
     [0.27270909377122865, -0.07162289063074784],
     [0.27270909377122865, -0.07162289063074784]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156],
     [-0.18270615661483125, 0.380195862180526],
     [0.35831933222388374, 0.1002778372399744],
     [0.24101500418095553, 0.16894045997102397],
     [-0.04718516811672353, 0.3937199374897597],
     [0.3487842959976363, 0.24460395380409142],
     [-0.39095072660278835, 0.2888583094138358],
     [-0.051929763378730585, -0.44812690773252367],
     [-0.26037544090496434, 0.3314083268269735],
     [0.27605097655218913, -0.30015438047215276],
     [-0.17205948891914308, -0.04576022461523524],
     [0.2180344742166115, 0.04293760886352001],
     [-0.23013515365769716, 0.4297320780204003],
     [0.27270909377122865, -0.07162289063074784],
     [0.27270909377122865, -0.07162289063074784]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156],
     [-0.18270615661483125, 0.380195862180526],
     [0.35831933222388374, 0.1002778372399744],
     [0.24101500418095553, 0.16894045997102397],
     [-0.04718516811672353, 0.3937199374897597],
     [0.3487842959976363, 0.24460395380409142],
     [-0.39095072660278835, 0.2888583094138358],
     [-0.051929763378730585, -0.44812690773252367],
     [-0.26037544090496434, 0.3314083268269735],
     [0.27605097655218913, -0.30015438047215276],
     [-0.17205948891914308, -0.04576022461523524],
     [0.2180344742166115, 0.04293760886352001],
     [-0.23013515365769716, 0.4297320780204003],
     [0.27270909377122865, -0.07162289063074784],
     [0.27270909377122865, -0.07162289063074784]]])
oc = torch.Tensor([[[0.2677033777832025, 0.1579239509786319],
                  [0.05812764876992554, 0.27595454455022583],
    [-0.05584088271134396, -0.17543671103059147],
    [0.21111173094425237, -0.1800381709232511],
    [0.08114505278531736, -0.02967572872861089],
    [-0.25983601818688, 0.3673055737629457],
    [-0.04444602921451757, -0.42474534554629156]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156]],
    [[0.2677033777832025, 0.1579239509786319],
     [0.05812764876992554, 0.27595454455022583],
     [-0.05584088271134396, -0.17543671103059147],
     [0.21111173094425237, -0.1800381709232511],
     [0.08114505278531736, -0.02967572872861089],
     [-0.25983601818688, 0.3673055737629457],
     [-0.04444602921451757, -0.42474534554629156]]])

# cut = torch.linspace(-0.5, 0.5, 21, dtype=torch.float32)
# voxel_features = torch.zeros([20, 20, 256])
# count = 0
# for i in range(len(cut)-1):
#     for j in range(len(cut)-1):
#         sc_voxel = sc[(sc[:, 0] > cut[i]) & (sc[:, 0] <= cut[i+1]) &
#                       (sc[:, 1] > cut[j]) & (sc[:, 1] <= cut[j+1])]
#         if len(sc_voxel) != 0:
#             # print(i, j)
#             # print(cut[i], cut[i+1], cut[j], cut[j+1])
#             # print(sc_voxel)
#             center = torch.Tensor(
#                     [(cut[i]+cut[i+1])/2, (cut[j]+cut[j+1])/2])
#             sc_voxel_centered = sc_voxel-center
#             print(sc_voxel_centered)
# print(torch.max(oc,dim=0).values)
# print(torch.transpose(oc,0,1))
# t = torch.randn([2, 5, 3, 3])
# print(t)
# t = torch.reshape(
#             t, (t.shape[0], t.shape[1],t.shape[2]*t.shape[3]))
# print(t)

pos = torch.Tensor(
    [[0.1, 0.2], [0.1, 0.2], [0.1, 0.2], [0.1, 0.2], [0.1, 0.2]])
print(net(sc, oc, pos).shape)

a = torch.Tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
a = torch.reshape(a, [1, 9])
print(a)
